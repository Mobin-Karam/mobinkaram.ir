---
title: "Koonj — community + payments platform"
slug: "koonj"
summary: "Mobile app for small communities to run paid memberships, live events, and gated content."
date: "2026-02-15"
tags: ["React Native", "NestJS", "PostgreSQL", "Realtime"]
stack: ["Expo", "NestJS", "PostgreSQL", "Redis", "tRPC"]
year: "2025-2026"
status: "Phase 2"
featured: true
author: "Mobin Karam"
authorAvatar: "https://github.com/Mobin-Karam.png"
readingMinutes: 6
cover: "/assets/images/koonj-cover.jpg"
published: true
---

## Problem
Local community organizers struggled to charge for memberships, manage RSVPs, and share member-only media without juggling multiple tools. Fragmented data meant churn risk and poor insight into active members.

## Architecture
Mobile-first client built with Expo, consuming a NestJS API behind an API gateway. PostgreSQL holds core membership data, Redis handles sessions and rate limiting, and a thin tRPC layer keeps the mobile client schema-aligned. Event and chat traffic flows through WebSockets with persistence fallbacks.

## Tech decisions
Chose Expo for rapid OTA updates, NestJS for opinionated modules, and tRPC to reduce drift between client and server contracts. Stripe Connect powers payouts while keeping PCI scope low. Media is stored in S3 with signed URLs to avoid shipping binaries in app updates.

## Challenges
Coordinating real-time chat with offline-first requirements pushed us to tune Redis persistence and add optimistic UI paths. Subscription proration edge cases required custom webhook handlers to avoid double-charging during plan switches.

## Security considerations
All privileged routes enforce organization-level RBAC. Webhooks are verified with secrets rotated via SSM. PII is encrypted at rest, and rate limits are applied per-tenant to contain abuse. Admin actions emit audit logs to CloudWatch with 30-day retention.

## Deployment
Blue/green deployments on AWS ECS Fargate with one-click rollbacks. Migrations run via Prisma in a pre-deploy step. CDN assets are fronted by CloudFront with image resizing at the edge.

## Lessons learned
Typed contracts (tRPC + Zod) reduced app-API mismatch bugs by ~40%. Investing in OTA pipelines early let us ship 6 hotfixes in the first launch week without app store delays.

## Next
Finish Phase 2 by adding self-serve onboarding for organizers, expand analytics dashboards, and harden chat moderation with ML-assisted flagging.
